<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    x = []
    flag = 'replace'
    oper_flag = 1
    show_flag=0
    function truncate (str) {
        for (var i = str.length-1; i>=0; i--){
            if (str[i] == oper) {
                return str.slice(0, i+1)
            }
        }
        $('#show').empty()
    }
    function press(num) {
        if (show_flag == 1) {
            $('#show').text(num)
        }else {$('#show').append(num)}

        if (flag == 'replace') {//replace display
            $('#display').text(num)
        }
        else {// or append display
            $('#display').append(num)
        }
        flag = 'append'
        oper_flag = 1
        show_flag = 0
    }

    function action(operator) {
        show_flag=0
        if (oper_flag == 1) {
            flag = 'replace'
            oper = operator
            x.push($('#display').text())
            x.push(operator)
            $('#show').append(operator)
            console.log('X: ', x)
            temp = x.slice()
            temp.pop()
            console.log('temp: ', temp)
            $('#display').text(eval(temp.join('')))
            oper_flag = 0
        }
    }

    $(document).ready(function () {
        $('#clear').click(function () {
            $('#show').empty()
            $('#display').text(0)
            x = []
            flag = 'replace'
            show_flag = 0
        })
        $('#clear_display').click(function () {
            var trunc = truncate($('#show').text())
            $('#show').text(trunc)
            $('#display').text(0)
            flag = 'replace'
            
           
        })
        $('#num1').click(function () {
            press(1)
        })

        $('#num2').click(function () {
            press(2)
        })

        $('#num3').click(function () {
            press(3)
        })
        $('#plus').click(function () {
            action('+')
        })
        $('#sub').click(function () {
            action('-')
        })
        $('#mul').click(function () {
            action('*')
        })
        $('#result').click(function () {
            x.push($('#display').text())
            //result = eval($('#show').text())
            $('#display').text(eval(x.join('')))
            $('#show').text('')
            x = []
            flag = 'replace'
            oper_flag = 1
            show_flag = 1
        })
    })

</script>

<style>
    .larger {
        font-size: 20px;
        padding: 30px;
    }
    .dark {
        background-color: #777;
    }
    .light{
        background-color: whitesmoke;
        
    }
</style>
<div class="container text-center dark">
    <div class='light'>
        <p id='show'></p>
        <h1 id='display'>0</h1>
    </div>
    <button class="larger" id="clear_display">CE</button>
    <button class="larger" id="clear">C</button>
    <button class="larger" id='num1'>1</button>
    <button class="larger" id='num2'>2</button>
    <button class="larger" id='num3'>3</button>
    <br>
    <button id='plus' class='larger'>+</button>
    <button id='mul' class='larger'>x</button>
    <button id='sub' class='larger'>-</button>
    <button class="larger" id="result">=</button>
</div>